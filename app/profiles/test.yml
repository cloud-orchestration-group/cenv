
config:
    command_profiles:
        host:
            command_base: host
            resource: true
            remove_count: 2
        group:
            command_base: group
            resource: true
            remove_count: 2
        task:

profile:
    "test_<<dict_key>>":
        foreach: "#[process_profiles]filter(@command_profiles, resource = false)"
        profile: "test/<<dict_key>>"
        ignore_missing: true

    "test_data_<<dict_key>>":
        foreach: "#[resource_profiles]filter(@command_profiles, resource = true)"
        profile: "test/<<dict_key>>"
        ignore_missing: true
        command_base: "<<command_base>>"
        data_type: "<<dict_key>>"

    "remove_<<dict_key>>":
        requires:
            - "#prefix(@process_profiles, test_)"
            - "#prefix(@resource_profiles, test_data_)"
        foreach: "#filter(@command_profiles, resource = true)"
        profile: test/data/remove
        operations: destroy
        data_type: "<<dict_key>>"
        command_base: "<<command_base>>"
        remove_count: "<<remove_count>>"
