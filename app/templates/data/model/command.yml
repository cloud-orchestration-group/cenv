#%- if plural %#
#%- set plural_name = plural %#
#%- else %#
#%- set plural_name = name + plural_suffix %#
#%- endif %#

#%- if mixins %#
#%- set command_mixins = [ base ] + mixins %#
#%- else %#
#%- set command_mixins = [ base ] %#
#%- endif %#

#
# Define data related command mixin with autogenerated field and method accessors
#
command_mixins:
    <{ name }>:
        aliases: ["<{ name }>_optional"]
        class: <{ class_name(name) }>Mixin
        mixins: <{ command_mixins }>
        meta:
            <{ name }>:
                data: <{ name }>
                relations: true
#%- if plugin %#
                provider: true
                default: <{ default_provider }>
#%- endif %#

    <{ plural_name }>:
        class: <{ class_name(name) }>MultipleMixin
        mixins: <{ command_mixins }>
        meta:
            <{ plural_name }>:
                data: <{ name }>
                relations: true
#%- if plugin %#
                provider: true
                default: <{ default_provider }>
#%- endif %#

#
# Define data related base command
#
command_base:
    <{ name }>:
        mixins: ["<{ name }>"]
        server_enabled: <{ server_enabled }>
        groups_allowed: <{ admin_roles }>

#
# Define data resource commands (list, get, save, remove, clear)
#
command:
#%- if not command_base %#
#%- set command_base = name %#
#%- endif %#
#%- for element in split_text(command_base, '\s+') %#
<{ element | indent(width = (loop.index * 4), first = true) }>:
#%- if loop.last %#
#%- set indent_space = ((loop.index + 1) * 4) %#
<{ '' | indent(width = indent_space, first = true) }>resource: <{ name }>
<{ '' | indent(width = indent_space, first = true) }>base: <{ name }>
<{ '' | indent(width = indent_space, first = true) }>base_name: <{ name }>
<{ '' | indent(width = indent_space, first = true) }>priority: <{ priority }>
#%- endif %#
#%- endfor %#
